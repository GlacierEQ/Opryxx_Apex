apiVersion: v1
kind: ConfigMap
metadata:
  name: opryxx-config
data:
  # Production environment settings
  ENVIRONMENT: "production"
  LOG_LEVEL: "INFO"
  
  # API configuration
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  
  # Feature flags
  FEATURE_AI_ANALYTICS: "true"
  FEATURE_ADVANCED_LOGGING: "true"
  
  # Resource limits
  MAX_CACHE_SIZE: "2GB"
  QUERY_TIMEOUT: "30s"
  
  # External service endpoints (injected via kustomize)
  DATABASE_URL: "postgresql://${DB_USER}:${DB_PASSWORD}@prod-db:5432/opryxx_prod"
  CACHE_URL: "redis://prod-cache:6379/1"
  
  # Security settings
  CORS_ALLOWED_ORIGINS: "https://app.opryxx.com,https://www.opryxx.com"
  RATE_LIMIT: "1000"
  
  # Monitoring and observability
  METRICS_ENABLED: "true"
  TRACING_ENABLED: "true"
  
  # Performance tuning
  WORKER_COUNT: "4"
  THREADS_PER_WORKER: "2"
  
  # Application-specific settings
  LOG_RETENTION_DAYS: "90"
  MAX_LOG_SIZE_MB: "50"
  
  # External integrations (injected via secrets)
  SENTRY_DSN: "${SENTRY_DSN}"
  NEW_RELIC_LICENSE_KEY: "${NEW_RELIC_LICENSE_KEY}"
  
  # Production-specific settings
  ENABLE_QUERY_CACHE: "true"
  QUERY_CACHE_TTL: "300"
  MAX_QUERY_COMPLEXITY: "100"
  
  # Security headers
  SECURE_HSTS_SECONDS: "31536000"
  SECURE_SSL_REDIRECT: "True"
  SESSION_COOKIE_SECURE: "True"
  CSRF_COOKIE_SECURE: "True"
  
  # Performance optimization
  ENABLE_GZIP: "true"
  ENABLE_HTTP2: "true"
  
  # Caching
  CACHE_TTL: "3600"
  ENABLE_REDIS_CACHE: "true"
  
  # Background tasks
  CELERY_BROKER_URL: "redis://prod-cache:6379/2"
  CELERY_RESULT_BACKEND: "redis://prod-cache:6379/3"
  
  # External services
  CDN_URL: "https://cdn.opryxx.com"
  MEDIA_URL: "https://media.opryxx.com"
  STATIC_URL: "https://static.opryxx.com"
  
  # API versioning
  API_VERSION: "v1"
  DEFAULT_PAGE_SIZE: "20"
  MAX_PAGE_SIZE: "100"
  
  # Monitoring endpoints
  METRICS_PORT: "9102"
  HEALTH_CHECK_PATH: "/healthz"
  READINESS_CHECK_PATH: "/readyz"
  LIVENESS_CHECK_PATH: "/livez"
  
  # Security headers
  CONTENT_SECURITY_POLICY: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https:; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://api.opryxx.com;"
  X_FRAME_OPTIONS: "DENY"
  X_CONTENT_TYPE_OPTIONS: "nosniff"
  X_XSS_PROTECTION: "1; mode=block"
  REFERRER_POLICY: "strict-origin-when-cross-origin"
  FEATURE_POLICY: "geolocation 'none'; midi 'none'; sync-xhr 'none'; microphone 'none'; camera 'none'; magnetometer 'none'; gyroscope 'none'; fullscreen 'self'; payment 'none'"
